"use strict";(self.webpackChunkjakarta_subway=self.webpackChunkjakarta_subway||[]).push([[63940],{10294(e,t,r){r.d(t,{S:()=>l});var s=r(15941),i=r(31633),o=r(20664),n=r(13927);function l(e,t,r){const l=function(e,t,r,s){const l=(e=>!Array.isArray(e[0]))(t)?(e,r)=>t[3*e+r]:(e,r)=>t[e][r],a=s?(0,i.GA)(s)/(0,i.G9)(s):1;return(0,n.lU)(e,(e,t)=>(0,o.j)(e,l(t,0)*a,l(t,1)*a,l(t,2)),r)}(a,e,t,r)?(0,n.Qj)(a):[0,0,1];return Math.abs(l[2])>Math.cos((0,s.kU)(80))?2:Math.abs(l[1])>Math.abs(l[0])?1:0}const a=(0,n.vt)()},14835(e,t,r){r.d(t,{w:()=>E});var s=r(53986),i=r(6326),o=r(69539),n=r(91967),l=r(59784),a=r(46053),h=(r(81806),r(76460),r(47249),r(87990)),c=r(35925);const d=["colors"],u=["colors"],p=["colors"],_=["colors"],g=["colors"],f=["colors"],y=.3;function v(e,t){t&&Object.assign(e,t)}class m{constructor(e){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=16,this.color=e.accent}}class w{constructor(e){let{colors:t}=e,r=(0,s.A)(e,d);this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=t.accent,this.outlineColor=t.outline,this.renderOccluded=16,this.hoverOutlineColor=t.selectedOutline,v(this,r)}applyColor(e){this._apply(this.color,e)}applyOutline(e){this._apply(this.outlineColor,e)}applyHoverOutline(e){this._apply(this.hoverOutlineColor,e)}_apply(e,t){t.setParameters({color:(0,l.QP)(e),renderOccluded:this.renderOccluded})}}class R{constructor(e){let{colors:t}=e,r=(0,s.A)(e,u);this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=2,this.minSquaredEdgeLength=900,this.color=(0,l._L)(t.accent,.5),this.hoverColor=t.accent,v(this,r)}applyColor(e){this._apply(this.color,e)}applyHover(e){this._apply(this.hoverColor,e)}_apply(e,t){t.setParameters({color:(0,l.QP)(e),renderOccluded:this.renderOccluded})}}class C{constructor(e){this.vertex=new w({colors:e,color:e.accent,outlineColor:e.outline}),this.edge=new w({colors:e,color:(0,l.Vl)((0,l._L)(e.accent,2/3),.5),outlineColor:(0,l._L)(e.outline,.5),size:8,collisionPadding:8}),this.selected=new w({colors:e,color:e.selected,outlineColor:e.outline}),this.edgeOffset=new R({colors:e})}}class b{constructor(e){let{colors:t}=e,r=(0,s.A)(e,p);this.width=1.5,this.stipplePattern=(0,c.wk)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=4,this.color=t.selected,this.stippleOffColor=t.outline,this.innerColor=t.selected,v(this,r)}apply(e){e.color=(0,l.QP)(this.color),e.width=this.width,e.stipplePattern=this.stipplePattern,e.stippleOffColor=(0,l.QP)(this.stippleOffColor),e.falloff=this.falloff,e.innerWidth=this.innerWidth,e.innerColor=(0,l.QP)(this.innerColor),e.renderOccluded=this.renderOccluded}}class O{constructor(e){let{colors:t}=e,r=(0,s.A)(e,_);this.size=4,this.outlineSize=1,this.shape="square",this.color=t.selected,this.outlineColor=t.outline,v(this,r)}apply(e){e.color=(0,l.QP)(this.color),e.size=this.size,e.outlineSize=this.outlineSize,e.outlineColor=(0,l.QP)(this.outlineColor),e.primitive=this.shape}}class A{constructor(e){let{colors:t}=e,r=(0,s.A)(e,g);this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=y,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=t.selected,this.glowColor=t.accent,this.heightFillColor=t.accent,v(this,r)}apply(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const r={glowColor:o.A.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:o.A.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*t*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=r:e.laserlineStyle=r}}class D{constructor(e){this.outline=new b({colors:e,color:e.stippleOff,renderOccluded:8,stippleOffColor:e.stippleOn,innerWidth:0}),this.staged=new b({colors:e,color:e.stippleOn,renderOccluded:8,innerColor:e.stagedSolid,stippleOffColor:e.stippleOff}),this.shadowStyle=new A({colors:e,globalAlpha:y,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1})}}class G{constructor(e){this.outline=new O({colors:e,color:e.selected,outlineColor:e.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new A({colors:e,globalAlpha:y,glowColor:e.accent,glowFalloff:1.5,glowWidth:6,innerColor:e.selected,innerWidth:1,radius:2})}}class P extends b{constructor(e){let{colors:t}=e,r=(0,s.A)(e,f);super({colors:t}),this.extensionType=2,v(this,r)}}class M{constructor(e){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new D(e),this.pointObjects=new G(e),this.heightPlane=new A({colors:e,globalAlpha:y,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:1}),this.heightBox=new A({colors:e,globalAlpha:y,glowColor:e.accent,glowFalloff:8,glowWidth:8,innerColor:e.selected,innerWidth:0,heightFillColor:e.accent}),this.zVerticalLine=new P({colors:e,color:(0,l._L)(e.accent,.5),falloff:2,innerColor:(0,l._L)(e.selected,0),renderOccluded:4,stipplePattern:null,width:5,extensionType:2})}}let E=class extends n.A{constructor(e){super(e)}get colors(){const e=this.getTheme().accentColor,t=e.a;return{accent:e,contrast:(0,l.bJ)(e),selected:o.A.fromArray([255,255,255,t]),selectedOutline:o.A.fromArray([255,255,255,t]),staged:o.A.fromArray([12,207,255,t]),stagedSolid:o.A.fromArray([12,207,255,1]),outline:o.A.fromArray([0,0,0,.5*t]),stippleOn:o.A.fromArray([255,255,255,1]),stippleOff:o.A.fromArray([0,0,0,.5])}}get visualElements(){return new M(this.colors)}get manipulators(){return new C(this.colors)}get zManipulator(){return new m(this.colors)}};(0,i.Cg)([(0,a.MZ)()],E.prototype,"colors",null),(0,i.Cg)([(0,a.MZ)()],E.prototype,"visualElements",null),(0,i.Cg)([(0,a.MZ)()],E.prototype,"manipulators",null),(0,i.Cg)([(0,a.MZ)()],E.prototype,"zManipulator",null),(0,i.Cg)([(0,a.MZ)()],E.prototype,"getTheme",void 0),E=(0,i.Cg)([(0,h.$)("esri.views.3d.interactive.editingTools.settings")],E)},29889(e,t,r){r.d(t,{A:()=>h,C:()=>a});var s=r(45308),i=r(44815),o=r(99785),n=r(67425),l=r(1599);function a(e,t,r,s){const l="polygon"===e.type?1:0,a="polygon"===e.type?e.rings:e.paths,{position:h,outlines:d}=(0,o.oR)(a,!!e.hasZ,l,e.spatialReference),u=(0,i.jh)(h.length),p=(0,n.au)(h,e.spatialReference,0,u,0,h,0,h.length/3,t,r,s),_=null!=p;return{lines:_?c(d,h,u):[],projectionSuccess:_,sampledElevation:p}}function h(e,t){const r="polygon"===e.type?1:0,i="polygon"===e.type?e.rings:e.paths,{position:n,outlines:a}=(0,o.oR)(i,!1,r),h=(0,s.projectBuffer)(n,e.spatialReference,0,n,t,0);for(let s=2;s<n.length;s+=3)n[s]=l.bi;return{lines:h?c(a,n):[],projectionSuccess:h}}function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=new Array;for(const{index:o,count:n}of e){if(n<=1)continue;const e=3*o,l=3*n;s.push({position:(0,i.l5)(t,3*o,3*n),mapPositions:null!=r?(0,i.l5)(r,e,l):void 0})}return s}},35925(e,t,r){r.d(t,{Xq:()=>n,wk:()=>o});const s={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},i={dash:s.dash,"dash-dot":[...s.dash,...s.dot],dot:s.dot,"long-dash":s["long-dash"],"long-dash-dot":[...s["long-dash"],...s.dot],"long-dash-dot-dot":[...s["long-dash"],...s.dot,...s.dot],none:null,"short-dash":s["short-dash"],"short-dash-dot":[...s["short-dash"],...s["short-dot"]],"short-dash-dot-dot":[...s["short-dash"],...s["short-dot"],...s["short-dot"]],"short-dot":s["short-dot"],solid:null};function o(e){return{pattern:[e,e],pixelRatio:2}}function n(e){return"style"===(null===e||void 0===e?void 0:e.type)?function(e){return null!=e?function(e,t){return null==e?e:{pattern:e.slice(),pixelRatio:t}}(i[e],8):null}(e.style):null}},41559(e,t,r){r.r(t),r.d(t,{ElevationProfileView3D:()=>G});var s=r(88321),i=r(30726),o=r(68134),n=r(48975),l=r(98773),a=r(54901),h=r(50346),c=r(12482),d=r(14835),u=r(73074),p=r(52447),_=r(90992);class g{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new d.w({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=(0,i.DC)(this._highlightTask),this._highlightHandle=(0,i.xt)(this._highlightHandle),this._visualElementHandle=(0,i.xt)(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!f(e))return;const t=e.layer;this._highlightTask=(0,l.UT)(async r=>{const s=await this._params.view.whenLayerView(t);(0,h.Te)(r),(0,_.Of)(s)&&(this._highlightHandle=s.highlight(e))})}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,r=new u.P({view:t,geometry:f(e)?e.geometry:null,attached:!1,elevationInfo:(0,c.bh)(e),renderOccluded:8,isDecoration:!0}),s=new p.y({graphic:e}),i=[(0,o.wB)(()=>s.isDraped,e=>{r.isDraped=e}),s.on("changed",()=>{r.geometry=f(e)?e.geometry:null}),t.trackGraphicState(s),t.maskOccludee(e),(0,a.DQ)(r)];this._settings.visualElements.lineObjects.outline.apply(r),r.attached=!0,this._visualElementHandle=(0,a.vE)(i)}}function f(e){return null!=e.geometry&&"polyline"===e.geometry.type}var y=r(6326),v=r(69539),m=r(91967),w=r(79468),R=r(46053),C=(r(81806),r(76460),r(47249),r(87990)),b=r(55855),O=r(54054),A=r(75042);let D=class extends m.A{constructor(e){super(e),this._chartData=null,this._visualElements=[],this._update=e=>{const{chartData:t}=e;if(null==t)return this.remove();if(!t.refined)return;const r=this._visualElements,s=t.lines.filter(e=>e.viewVisualizationEnabled),i=s.length;for(;r.length>i;)r.pop().destroy();const o=(0,O.zj)().profileLinesStyle3D;for(;r.length<i;){const e=new u.P({view:this.view,elevationInfo:{mode:"absolute-height",offset:0},innerWidth:o.innerWidth,innerColor:o.innerColor,width:o.width,falloff:o.falloff,renderOccluded:o.renderOccluded,isDecoration:!0});r.push(e)}const n=e.spatialReference;for(let l=0;l<i;++l){const e=r[l],t=s[i-1-l];e.geometry=(0,A.T)(t,n),e.color=(0,b.ci)(v.A.toUnitRGBA(t.color))}}}initialize(){const e=(0,O.zj)().profileLinesUpdateThrottleMillis;let t=this._update;if(e>0){const r=(0,w.n)(this._update,e);this.addHandles(r),t=r}this.addHandles([(0,o.wB)(()=>({spatialReference:this.view.spatialReference,chartData:this._chartData}),t,o.pc)])}destroy(){this._destroyVisualElements()}remove(){this._destroyVisualElements()}update(e){this._chartData=e}_destroyVisualElements(){this._visualElements.forEach(e=>e.destroy()),this._visualElements.length=0}};(0,y.Cg)([(0,R.MZ)()],D.prototype,"view",void 0),(0,y.Cg)([(0,R.MZ)()],D.prototype,"_chartData",void 0),D=(0,y.Cg)([(0,C.$)("esri.widgets.ElevationProfile.support.ProfileLines3D")],D);class G{constructor(e,t){this._handles=new s.A,this._inputRepresentation=new g({view:e}),this._hoveredPoints=new n.t({view:e}),this._profileLines=new D({view:e}),this._handles.add([(0,o.wB)(()=>t.viewModel.hoveredPoints,e=>this._hoveredPoints.update(e),o.pc),(0,o.wB)(()=>{const{state:e,editable:r,highlightEnabled:s,viewModel:i}=t,o=i.input;return o&&(o.commitProperty("geometry"),o.commitProperty("layer")),{input:o,state:e,editable:r,highlightEnabled:s}},e=>this._updateInputRepresentation(e),o.pc),(0,o.wB)(()=>t.viewModel.chartData,e=>this._profileLines.update(e),o.pc),(0,o.wB)(()=>{var e;return null===(e=t.viewModel.input)||void 0===e?void 0:e.geometry},()=>{this._profileLines.remove()},o.pc)])}destroy(){this._handles=(0,i.pR)(this._handles),this._inputRepresentation=(0,i.pR)(this._inputRepresentation),this._hoveredPoints=(0,i.pR)(this._hoveredPoints),this._profileLines=(0,i.pR)(this._profileLines)}_updateInputRepresentation(e){let{input:t,state:r,editable:s,highlightEnabled:i}=e;const o=this._inputRepresentation;if(!i)return o.remove();"selected"===r?o.showHighlight(t):"created"!==r||s?o.remove():o.showReshaping(t)}}},52447(e,t,r){r.d(t,{y:()=>l});var s=r(6326),i=r(54099),o=r(46053),n=(r(81806),r(76460),r(47249),r(87990));let l=class extends i.nJ{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};(0,s.Cg)([(0,o.MZ)({constructOnly:!0})],l.prototype,"graphic",void 0),(0,s.Cg)([(0,o.MZ)()],l.prototype,"tracking",void 0),(0,s.Cg)([(0,o.MZ)()],l.prototype,"displaying",void 0),(0,s.Cg)([(0,o.MZ)()],l.prototype,"error",void 0),(0,s.Cg)([(0,o.MZ)()],l.prototype,"isDraped",void 0),l=(0,s.Cg)([(0,n.$)("esri.views.3d.layers.graphics.GraphicState")],l)},73074(e,t,r){r.d(t,{P:()=>R});var s=r(54099),i=r(20664),o=r(9392),n=r(43047),l=r(55855),a=r(45308),h=r(42294),c=r(44815),d=r(18117),u=r(12482),p=r(731),_=r(85746),g=r(1307),f=r(49296),y=r(70667),v=r(29889),m=r(442),w=r(52479);class R extends _.X{constructor(e){var t;super(e),this._attachmentOrigin=(0,d.TH)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new s.bk,this._geometry=null,this._width=1,this._color=(0,l.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,l.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=8,this._attachmentOrigin.spatialReference=e.view.spatialReference,this._laserline=new g.o({view:e.view,isDecoration:e.isDecoration}),this.applyProperties(e),this.attached=null===(t=e.attached)||void 0===t||t}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:C,recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)},forEachMaterial:(e,t)=>t(e.material)}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:C,recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()},forEachMaterial:(e,t)=>t(e.material)}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e,this._updateMaterial()}get geometry(){return this._geometry}set geometry(e){const t=this._isClosed;this._geometry=e,this.recreateGeometry(),t!==this._isClosed&&this._updateMaterial()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,n.a)(e,this._color)||((0,n.d)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,n.a)(e,this._innerColor)||((0,n.d)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,n.a)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,l.o8)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){var e;if(!this._attachmentOriginDirty)return this._attachmentOrigin;const t=null===(e=this.object3dResources.resources)||void 0===e?void 0:e.geometries;if(!t||0===t.length)return null;(0,i.j)(O,0,0,0);let r=0;for(const s of t)s.computeAttachmentOrigin(b)&&((0,i.g)(O,O,b),r++);return 0===r?null:((0,i.h)(O,O,1/r),this.view.renderCoordsHelper.fromRenderCoords(O,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){var e,t;null!==(e=this.object3dResources.resources)&&void 0!==e&&e.material.setParameters(this._materialParameters),null===(t=this.drapedResources.resources)||void 0===t||t.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&8===this._renderOccluded?4:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const s of r)e.addGeometry(s);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(e){const t=new w.W(this._materialParameters,this.view.state.isGlobal),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r}}_createDrapedResources(){const e=new w.W(this._materialParameters,this.view.state.isGlobal);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,s=r.basemapTerrain.spatialReference;return null==t||null==s?[]:(0,v.A)(t,s).lines.map(t=>{let{position:i}=t;const o={overlayInfo:{spatialReference:s,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:i},removeDuplicateStartEnd:this._isClosed};return new m.$((0,y.te)(e,o))})}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const s=r.attributes.get("position"),i=(0,c.jh)(s.data.length);(0,a.projectBuffer)(s.data,t.spatialReference,0,i,this.view.spatialReference,0),(0,h.Hq)(e,i)}return!0}_createRenderGeometries(e,t){var r;const s=this.geometry;if(null==s)return;const i=(0,v.C)(s,this.view.elevationProvider,this.view.renderCoordsHelper,f.F.fromElevationInfo(null!==(r=this.elevationInfo)&&void 0!==r?r:new p.A({mode:(0,u.w7)(s,null)}))),o=new Array;for(const{position:n,mapPositions:l}of i.lines){const r={mapPositions:l,attributeData:{position:n},removeDuplicateStartEnd:this._isClosed};t.push((0,y.te)(e,r)),o.push(n)}this._laserline.pathVerticalPlane=o}}function C(e){e.geometries=[]}const b=(0,o.vt)(),O=(0,o.vt)()},77176(e,t,r){r.d(t,{b:()=>o});var s=r(15941),i=r(38496);function o(e,t,r){var o;const c=Array.isArray(e),d=c?e.length/t:e.byteLength/(4*t),u=c?e:new Uint32Array(e,0,d*t),p=null!==(o=null===r||void 0===r?void 0:r.minReduction)&&void 0!==o?o:0,_=(null===r||void 0===r?void 0:r.originalIndices)||null,g=_?_.length:0,f=(null===r||void 0===r?void 0:r.componentOffsets)||null;let y=0;if(f)for(let s=0;s<f.length-1;s++){const e=f[s+1]-f[s];e>y&&(y=e)}else y=d;const v=Math.floor(1.1*y)+1;(null==h||h.length<2*v)&&(h=new Uint32Array((0,s.cU)(2*v)));for(let s=0;s<2*v;s++)h[s]=0;let m=0;const w=!!f&&!!_,R=w?g:d;let C=(0,i.my)(d);const b=new Uint32Array(g),O=1.96;let A=0!==p?Math.ceil(4*O*O/(p*p)*p*(1-p)):R,D=1,G=f?f[1]:R;for(let s=0;s<R;s++){if(s===A){const e=1-m/s;if(e+O*Math.sqrt(e*(1-e)/s)<p)return null;A*=2}if(s===G){for(let e=0;e<2*v;e++)h[e]=0;if(_)for(let e=f[D-1];e<f[D];e++)b[e]=C[_[e]];G=f[++D]}const e=w?_[s]:s,r=e*t,i=a(u,r,t);let o=i%v,l=m;for(;0!==h[2*o+1];){if(h[2*o]===i){const e=h[2*o+1]-1;if(n(u,r,e*t,t)){l=C[e];break}}o++,o>=v&&(o-=v)}l===m&&(h[2*o]=i,h[2*o+1]=e+1,m++),C[e]=l}if(0!==p&&1-m/d<p)return null;if(w){for(let e=f[D-1];e<b.length;e++)b[e]=C[_[e]];C=(0,i.uW)(b)}const P=c?new Array(m):new Uint32Array(m*t);m=0;for(let s=0;s<R;s++)C[s]===m&&(l(u,(w?_[s]:s)*t,P,m*t,t),m++);if(_&&!w){const e=new Uint32Array(g);for(let t=0;t<e.length;t++)e[t]=C[_[t]];C=(0,i.uW)(e)}return{buffer:Array.isArray(P)?P:P.buffer,indices:C,uniqueCount:m}}function n(e,t,r,s){for(let i=0;i<s;i++)if(e[t+i]!==e[r+i])return!1;return!0}function l(e,t,r,s,i){for(let o=0;o<i;o++)r[s+o]=e[t+o]}function a(e,t,r){let s=0;for(let i=0;i<r;i++)s=e[t+i]+s|0,s=s+(s<<11)+(s>>>2)|0;return s>>>0}let h=null},85746(e,t,r){r.d(t,{X:()=>g});var s=r(6326),i=r(91967),o=r(5632),n=r(46053),l=(r(81806),r(76460),r(47249),r(87990));class a{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=2}destroy(){this._destroyResources()}get resources(){var e;return null===(e=this._resources)||void 0===e?void 0:e.external}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){var t;this._renderGroup=e;const r=null===(t=this._resources)||void 0===t?void 0:t.layerView;r&&(r.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new h({view:this._resourceFactory.view,renderGroup:this._renderGroup}),r=this._resourceFactory.view.overlayManager;this._resources={layerView:t,external:e,geometriesAdded:!1},r&&(this._resources.drapeSourceRenderer=r.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){var e;null!=(null===(e=this._resources)||void 0===e?void 0:e.drapeSourceRenderer)&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,1),this._resources.geometriesAdded=!0))}}let h=class extends((0,o.sA)(i.A)){constructor(e){super(e),this.drapeSourceType=1,this.updatePolicy=1,this.renderGroup=2}};(0,s.Cg)([(0,n.MZ)({constructOnly:!0})],h.prototype,"view",void 0),(0,s.Cg)([(0,n.MZ)({readOnly:!0})],h.prototype,"drapeSourceType",void 0),(0,s.Cg)([(0,n.MZ)()],h.prototype,"renderGroup",void 0),h=(0,s.Cg)([(0,l.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],h);var c=r(69230),d=r(68134),u=r(37046),p=r(8918);class _{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view.stage;if(null==this._resources||!e)return;const t=this._resources.object;t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer)}forEachMaterial(e){this._resources&&this._resourceFactory.forEachMaterial(this._resources.external,e)}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,r=t.stage;if(!r)return;const s=new p.x(r,{pickable:!1,updatePolicy:1}),i=new u.B({castShadow:!1}),o=e.createResources(i,s);s.add(i);const n=e.cameraChanged,l=n?(0,d.wB)(()=>t.state.camera,e=>n(e),d.Vh):null;this._resources={layer:s,object:i,external:o,cameraHandle:l},this._syncVisible()}_destroyResources(){var e;null!=this._resources&&(this._resources.layer.destroy(),this._resources.object.dispose(),null!==(e=this._resources.cameraHandle)&&void 0!==e&&e.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null)}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class g extends c.B{constructor(e){var t;super(e),this._isDraped=!1,this.object3dResources=new _(this.createObject3DResourceFactory(e.view)),this.drapedResources=new a(this.createDrapedResourceFactory(e.view)),this.isDraped=null!==(t=e.isDraped)&&void 0!==t&&t}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}forEachMaterial(e){var t,r;null!==(t=this.object3dResources)&&void 0!==t&&t.forEachMaterial(e),null===(r=this.drapedResources)||void 0===r||r.forEachMaterial(e)}}},99785(e,t,r){r.d(t,{lO:()=>h,oR:()=>c});var s=r(38983),i=r(5262),o=r(44815),n=r(38496),l=r(10294),a=r(77176);function h(e){const t=c(e.rings,e.hasZ,1,e.spatialReference),r=new Array;let i=0,l=0;for(const a of t.polygons){const e=a.count,h=a.index,c=(0,o.l5)(t.position,3*h,3*e),d=a.holeIndices.map(e=>e-h),u=(0,n.uW)((0,s.e)(c,d,3));r.push({position:c,faces:u}),i+=c.length,l+=u.length}const h=function(e,t,r){if(1===e.length)return e[0];const s=(0,o.jh)(t),i=new Array(r);let l=0,a=0,h=0;for(const o of e){for(let e=0;e<o.position.length;e++)s[l++]=o.position[e];for(const e of o.faces)i[a++]=e+h;h=l/3}return{position:s,faces:(0,n.uW)(i)}}(r,i,l),d=Array.isArray(h.position)?(0,a.b)(h.position,3,{originalIndices:h.faces}):(0,a.b)(h.position.buffer,6,{originalIndices:h.faces});return h.position=(0,o.xm)(new Float64Array(d.buffer)),h.faces=d.indices,h}function c(e,t,r,s){const i=e.length,n=new Array(i),l=new Array(i),a=new Array(i);let h=0;for(let o=0;o<i;++o)h+=e[o].length;let c=0,p=0,_=0;const g=(0,o.jh)(3*h);let f=0;for(let o=i-1;o>=0;o--){const h=e[o],y=1===r&&u(h,t,s);if(y&&1!==i)n[c++]=h;else{let e=h.length;for(let t=0;t<c;++t)e+=n[t].length;const r={index:f,pathLengths:new Array(c+1),count:e,holeIndices:new Array(c)};r.pathLengths[0]=h.length,h.length>0&&(a[_++]={index:f,count:h.length}),f=y?d(h,h.length-1,-1,g,f,h.length,t):d(h,0,1,g,f,h.length,t);for(let s=0;s<c;++s){const e=n[s];r.holeIndices[s]=f,r.pathLengths[s+1]=e.length,e.length>0&&(a[_++]={index:f,count:e.length}),f=d(e,0,1,g,f,e.length,t)}c=0,r.count>0&&(l[p++]=r)}}for(let o=0;o<c;++o){const e=n[o];e.length>0&&(a[_++]={index:f,count:e.length}),f=d(e,0,1,g,f,e.length,t)}return l.length=p,a.length=_,{position:g,polygons:l,outlines:a}}function d(e,t,r,s,i,o,n){i*=3;for(let l=0;l<o;++l){const o=e[t];s[i++]=o[0],s[i++]=o[1],s[i++]=n&&o[2]?o[2]:0,t+=r}return i/3}function u(e,t,r){if(!t)return!(0,i.$3)(e);const s=e.length-1;switch((0,l.S)(e,s,r)){case 0:return!(0,i.$3)(e,1,2);case 1:return!(0,i.$3)(e,0,2);case 2:return!(0,i.$3)(e,0,1)}}}}]);
//# sourceMappingURL=63940.9c11aefe.chunk.js.map